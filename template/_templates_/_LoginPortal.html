<!--Begin LoginPortal-->
[%divId="LoginPortal"%]
[%spwfResource="security_user"%]

<script type="text/javascript">
//<![CDATA[
function loginCall(){
  var params = bindForm("[%divId%]Form");
  [%#prepParams will not work here %]
  params['spwfResource'] = "security_user";
  params['spwfAction'] = "authenticate";
  var successf = function (rslt){
    if(!rslt[SERVER_SIDE_FAIL]){
	   var r = rslt.rows[0];
	   if(r.session_id ==""){
		alert("Sorry, I Couldn't validate those Credentials");
		$("#password").val("");
	   }else{
		statusMsg("Successfully Authenticated User: " + r.user_id );
		usrSessionId = r.session_id;
		usrLoginId = r.user_id;
		onSuccessfulLogin();
	   }
	   }else{
	briefNotify("There was a problem communicating with the Server.","ERROR")
      }

  };
  if (validate[%divId%]Form())serverCall(params,successf,FAILF);
}


function validate[%divId%]Form (){
  var formValid  = standardValidate("[%divId%]Form");
  return formValid;
}

function onSuccessfulLogin(){
	$("#password").val("");
	displayMainLayout(true);
	$("#topMenuBar").show();
	registerAction();
	timeoutIfNoAction();
	showLaunchPane();
	retrieveCache();
}
function logOutUser(){
  usrSessionId="";
  usrLoginId="";
  $("form#[%divId%]Form #user_id").val("");
  $("form#[%divId%]Form #password").val("");
  displayMainLayout(false);
  $("#topMenuBar").hide();
  hideMainContent();
  return;
}


$(document).ready(function(){
	$("form#[%divId%]Form #user_id").val("golfscore");
	$("form#[%divId%]Form #password").val("golfscore");
	showLoginPortal();
});

function showLoginPortal(){
  $(document).keypress(function(e) {
    if(e.keyCode == 13) {//enter
        loginCall();
    }
  });
}

//]]>
</script>
<div id="[%divId%]"  class="contentPane container">
  <div class="row ">
	<img class="center" id="headerSplash" src="./images/headerphoto.jpg" alt="Login Page Splash">
  </div>
  <div  id="loginFormRow" class="row ">
    <form id="[%divId%]Form"  >  
      <fieldset > 
       <div class="center" style="width:25em;"> 
   	<div class="prettyFormHolder "  > 
   	  <table class="formLayout" >
    	    <tr><td colspan="3" class="formHeaderTD"><span class="formHeader">Login</span> <br/>
		<span class="small" >Please enter your login credentials</span><hr/></td>
	    </tr>
    	    <tr>
    	      <td class="labelColumn" style="" ><label for="user_id" id="user_id_label" >User ID</label> </td> 
              <td><input type="text"  name="user_id" id="user_id" size="30" class="fieldbox VALIDATErequired"  /> </td> <td>
			<span class="ValidationMsg" id="user_idError"></span></td>
     	    </tr>
	    <tr>
    		<td class="labelColumn"><label for="password" id="password_label">Password</label>  </td>
    		<td><input type="password" name="password" id="password" size="30" class="fieldbox VALIDATErequired"  />  
		</td>  
		<td><span class="ValidationError" id="passwordError"></span></td>
     	    </tr>
	    <tr>
    		<td colspan="3" align="center" style="padding: 15px; ">
		  <button type="button"  id="cmdlogin" class="custombutton "  onclick="loginCall()" > Login </button>  
    		</td>
	    </tr>
        </table>
</div>
</div[%#prettyFormHolder%]>  
</fieldset>  
</form>  
</div>
</div> <!--loginportal--> 
<!--End LoginPortal-->
