<!--Begin LoginPortal-->

<script type="text/javascript">

function authenticateUser(){
"use strict";
  var startTime, stopTime;
  var params = {};
  params['spwfResource'] = "security_user";
  params['spwfAction'] = "authenticate";
  params['user_id'] = $("#user_id").val();
  params['password'] = $("#password").val();

  startTime= new Date();
    $.post(urlTarget,params, function(responseJSON){ 
		stopTime=new Date();
		if(!validateServerResponse(responseJSON)){
			alert("Sorry, I Couldn't validate those Credentials");
			 $("#password").val("");
			return false;
		}		
 		var r = responseJSON.rows[0];
		usrSessionId = r.session_id;
		usrLoginId = r.user_id;
		$("#statusMsg").html("Successfully Authenticated User in " + (stopTime.getTime()-startTime.getTime())/1000 + "s" );
		onSuccessfulLogin();
		

        });  
}

function onSuccessfulLogin(){
	$("#password").val("");
	displayMainLayout(true);
	$("#topMenuBar").show();
	registerAction();
	timeoutIfNoAction();
	setMainContentPane(showGolfScoreSummary);
	retrieveGolfScoreSummary();
	retrieveCache();

}
// timeout function
function timeoutIfNoAction(){ "use strict";
	var timeSince = new Date().getTime() - usrLastAction.getTime() ;
	if(usrLoginId !="" && timeSince >usrTimeOutDuration ){
		usrLogoutScheduled = true;
		$("#statusMsg").html("Logging Out User in 1 minute");
		window.setTimeOut(function(){if (usrLogoutScheduled){logOutUser();}},60000);
	}else{
	  window.setTimeout(timeoutIfNoAction, usrTimeOutDuration +1000  );
	}

}
function registerAction(){
usrLastAction= new Date();
usrLogoutScheduled = false;


}


function logOutUser(){
  location.reload(true);
return;
}
function validateLoginForm(){ "use strict";
        $('.error').hide(); 
        $('.error').html(""); 
	if( isValidOrNotifyFail(!isFieldIdEmpty("user_id"),"user_id","*Required")
	  & isValidOrNotifyFail(!isFieldIdEmpty("password"),"password","*Required")
	){
	  //alert("ok");
	  //displayMainLayout(true);
	  return true;
	}else{
	  //alert ("failed");
	  return false;
        }
}//end validateLoginForm();

</script>

<div id="LoginPortal" style="position:fixed; height:100%; width:100%">
<img align="center" height="150" width ="470" src="./img/headerphoto.jpg">
<div  class="vcenter">
<form name="loginForm" action="">  
  <fieldset style="border:0">  
<!-- -->
    <table class="formLayout" style="margin: auto;" vertical-align="middle">
    <tr><td colspan="3" class="formHeaderTD"><span class="formHeader">Login</span> <br/>
	<span class="small" >Please enter your login credentials</span><hr/></td></tr>
    <tr>
    <td class="labelColumn" style="" ><label for="user_id" id="user_id_label" >User ID</label> </td> 
    <td><input type="text" name="user_id" id="user_id" size="30" value="" class="fieldbox" /> </td> 
    <td class="errorColumn">   <label class="error" for="user_id" id="user_id_error"></label> </td> 
     </tr><tr>
    <td class="labelColumn"><label for="password" id="password_label">Password</label>  </td>
    <td><input type="password" name="password" id="password" size="30" value="" class="fieldbox" />  </td> 
    <td class="errorColumn">   <label class="error" for="password" id="password_error"></label>  </td>
     </tr><tr>
    <td colspan="3" align="center" style="padding: 15px"><button type="submit" name="submit"  id="login_button" class="custombutton" value="Send" > Login </button>  </td>
</tr></table>


  </fieldset>  
</form>  
</div>
</div> <!--loginportal--> 
<!--End LoginPortal-->
